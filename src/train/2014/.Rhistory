hmda_data_df_ <- fread("/Users/omkarpawar/Desktop/Data/PA/hmda_2015_pa_imputed.csv")
library(corrplot)
library(ggplot2)
library(tidyr)
library(stringr)
library(dplyr)
library(data.table)
library(mice)
library(rstudioapi)
library(naniar)
library(caret)
library(pROC)
library(ROCR)
library(precrec)
hmda_data_df_ <- fread("/Users/omkarpawar/Desktop/Data/PA/hmda_2015_pa_imputed.csv")
hmda_data_df <- as.data.frame(hmda_data_df_)
source(paste(dirname(dirname(dirname(rstudioapi::getActiveDocumentContext()$path))), "utils/utils.r", sep="/"))
source(paste(dirname(dirname(dirname(rstudioapi::getActiveDocumentContext()$path))), "utils/model_utils.r", sep="/"))
hmda_data_df <- as.data.frame(hmda_data_df_)
hmda_data_df_for_model <- hmda_data_frame_for_model(hmda_data_df)
hmda_data_df_for_model <- process_model_df_columns(hmda_data_df_for_model)
set.seed(400)
split_dfs <- train_test_split(hmda_data_df_for_model$loan_granted, hmda_data_df_for_model)
train <- split_dfs[[1]]
test <- split_dfs[[2]]
library("randomForest")
set.seed(1234)
rf_formula = loan_granted~applicant_race_and_ethnicity + applicant_income_000s + loan_amount_000s + preapproval + co_applicant_present + minority_population + loan_purpose + tract_to_msamd_income + applicant_sex + property_type + owner_occupancy + agency_code + rate_spread + respondent_id
rf_model <- randomForest(rf_formula,data=train,ntree=128)
pred = predict(rf_model, newdata=test)
#table(pred, test$loan_granted)
cm<-confusionMatrix(pred,test$loan_granted, positive = "yes")
draw_confusion_matrix(cm,"Loan Granted","Loan Denied")
